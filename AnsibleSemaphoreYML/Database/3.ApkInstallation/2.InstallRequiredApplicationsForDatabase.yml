---
- name: Install prerequisites for MariaDB setup
  hosts: all
  become: true
  become_method: sudo
  become_user: root

  vars:
    ansible_sudo_pass: "{{ lookup('env', 'USER_PASSWORD') }}"
    
    # System packages to install
    packages_to_install:
      - sudo
      - python3-pip
      - python3-dev
      - libmariadb-dev  # MariaDB development library
      - build-essential  # Useful for compiling packages

    # Python packages to install
    python_packages_to_install:
      - PyMySQL
      - mysqlclient  # MySQL client library for Python

  tasks:
    - name: Install system packages
      apt:
        name: "{{ item }}"
        state: present
      loop: "{{ packages_to_install }}"

    - name: Install Python packages
      pip:
        name: "{{ item }}"
        state: present
        executable: pip3
      loop: "{{ python_packages_to_install }}"
